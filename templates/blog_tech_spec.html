{% extends "base.html" %}

{% block content %}
<div class="min-h-screen bg-gray-50">
    <!-- Header Section -->
    <section class="py-16 bg-white">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h1 class="text-4xl font-bold text-gray-800 mb-4">Blog System</h1>
                <p class="text-xl text-gray-600 mb-8">A full-stack blog solution with register, login/out, post, comment, delete with users management</p>
                <div class="flex justify-center space-x-4">
                    <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium">Flask</span>
                    <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">SQLAlchemy</span>
                    <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-medium">WTForms</span>
                    <span class="bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm font-medium">Blueprint</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Technical Architecture Section -->
    <section class="py-16 bg-white">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center mb-12">Technical Architecture</h2>
            
            <!-- Overview -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Overview</h3>
                <div class="bg-gray-50 p-6 rounded-lg">
                    <p class="text-gray-700 mb-4">
                        The blog system is a modular and self-contained component, implemented as a Flask Blueprint, that provides a complete set of features for a multi-user blog. 
                        It's designed to be seamlessly integrated into a larger Flask application with clear separation of concerns.
                    </p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
                        <div class="bg-white p-4 rounded border">
                            <h4 class="font-semibold text-gray-800 mb-2">Core Technologies</h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>• Flask (Python web framework)</li>
                                <li>• SQLAlchemy with shared database instance</li>
                                <li>• WTForms for form handling and validation</li>
                                <li>• Flask-Login for authentication</li>
                                <li>• Blueprint architecture for modular design</li>
                            </ul>
                        </div>
                        <div class="bg-white p-4 rounded border">
                            <h4 class="font-semibold text-gray-800 mb-2">Key Features</h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>• User registration and authentication</li>
                                <li>• Role-based access control</li>
                                <li>• Blog post creation and management</li>
                                <li>• Comment system</li>
                                <li>• Admin dashboard</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Module Structure -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Module Structure</h3>
                <div class="bg-gray-50 p-6 rounded-lg">
                    <div class="font-mono text-sm bg-white p-4 rounded border overflow-x-auto">
                        <pre>blog_project/
├── __init__.py      # Package initialization
├── main.py          # Flask routes and blueprint definition
├── models.py        # SQLAlchemy database models
├── forms.py         # WTForms form definitions
├── templates/       # HTML templates
│   ├── header.html
│   ├── footer.html
│   ├── indexb.html
│   ├── login.html
│   ├── register.html
│   ├── make-post.html
│   ├── post.html
│   └── admin_dashboard.html
└── static/          # CSS, JS, and assets</pre>
                    </div>
                </div>
            </div>

            <!-- Data Layer -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Data Layer (models.py)</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">User Model</h4>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li>• id: Primary key</li>
                            <li>• email: Unique email address</li>
                            <li>• password: Hashed password</li>
                            <li>• name: User's full name</li>
                            <li>• badge: Unique badge number</li>
                            <li>• pin: Hashed PIN for authentication</li>
                            <li>• category: Role-based access control</li>
                            <li>• company: Optional company name</li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">BlogPost Model</h4>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li>• id: Primary key</li>
                            <li>• author_id: Foreign key to User</li>
                            <li>• title: Post title (unique)</li>
                            <li>• subtitle: Post subtitle</li>
                            <li>• date: Publication date</li>
                            <li>• body: Post content (rich text)</li>
                            <li>• img_url: Featured image URL</li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Comment Model</h4>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li>• id: Primary key</li>
                            <li>• text: Comment content</li>
                            <li>• author_id: Foreign key to User</li>
                            <li>• post_id: Foreign key to BlogPost</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- API Endpoints -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">API Endpoints</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Authentication</h4>
                        <ul class="text-sm text-gray-600 space-y-2">
                            <li><code class="bg-gray-100 px-2 py-1 rounded">GET/POST /register</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded">GET/POST /login</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded">GET /logout</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded">POST /api/authenticate_badge_pin</code></li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Blog Management</h4>
                        <ul class="text-sm text-gray-600 space-y-2">
                            <li><code class="bg-gray-100 px-2 py-1 rounded">GET /</code> (all posts)</li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded">GET/POST /post/&lt;id&gt;</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded">GET/POST /new-post</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded">GET/POST /edit-post/&lt;id&gt;</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded">GET /delete/&lt;id&gt;</code></li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Admin Functions</h4>
                        <ul class="text-sm text-gray-600 space-y-2">
                            <li><code class="bg-gray-100 px-2 py-1 rounded">GET /admin/dashboard</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded">POST /admin/delete_user/&lt;id&gt;</code></li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Authentication & Authorization -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Authentication & Authorization</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Authentication System</h4>
                        <ul class="text-sm text-gray-600 space-y-2">
                            <li>• Flask-Login for session management</li>
                            <li>• Secure password hashing with werkzeug</li>
                            <li>• Dual authentication (email/password + badge/PIN)</li>
                            <li>• CSRF protection with WTForms</li>
                            <li>• Automatic session handling</li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Role-Based Access Control</h4>
                        <ul class="text-sm text-gray-600 space-y-2">
                            <li>• @roles_required decorator for fine-grained control</li>
                            <li>• User categories: executive, director, vip, manager, etc.</li>
                            <li>• Executive: Full admin access</li>
                            <li>• Director: Can create/edit posts</li>
                            <li>• Regular users: Read and comment only</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Database Relationships -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Database Relationships</h3>
                <div class="bg-gray-50 p-6 rounded-lg">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-white p-4 rounded border">
                            <h5 class="font-semibold text-gray-800 mb-2">User → Posts</h5>
                            <p class="text-sm text-gray-600">One-to-many relationship where one user can author multiple posts</p>
                        </div>
                        <div class="bg-white p-4 rounded border">
                            <h5 class="font-semibold text-gray-800 mb-2">User → Comments</h5>
                            <p class="text-sm text-gray-600">One-to-many relationship where one user can write multiple comments</p>
                        </div>
                        <div class="bg-white p-4 rounded border">
                            <h5 class="font-semibold text-gray-800 mb-2">Post → Comments</h5>
                            <p class="text-sm text-gray-600">One-to-many relationship where one post can have multiple comments</p>
                        </div>
                    </div>
                    <div class="mt-4 bg-blue-50 p-4 rounded">
                        <h5 class="font-semibold text-blue-800 mb-2">Cascading Deletes</h5>
                        <p class="text-blue-700 text-sm">When a user is deleted, all their posts and comments are automatically removed from the database.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Implementation Details Section -->
    <section class="py-16 bg-gray-50">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center mb-12">Implementation Details</h2>
            
            <!-- Blueprint Architecture -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Blueprint Architecture</h3>
                <div class="space-y-6">
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Blueprint Definition</h4>
                        <div class="bg-gray-50 p-4 rounded border">
                            <pre class="text-sm overflow-x-auto"><code>blog_bp = Blueprint('blog', __name__, 
                    template_folder='templates',
                    static_folder='static',
                    static_url_path='/blog_project/static')</code></pre>
                        </div>
                        <p class="text-gray-700 mt-4">The blueprint has its own dedicated template and static folders, ensuring modularity and organization.</p>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Application Integration</h4>
                        <div class="bg-gray-50 p-4 rounded border">
                            <pre class="text-sm overflow-x-auto"><code>from blog_project.main import blog_bp
app.register_blueprint(blog_bp, url_prefix='/blog_project')</code></pre>
                        </div>
                        <p class="text-gray-700 mt-4">All routes are accessible under the /blog_project prefix (e.g., /blog_project/login, /blog_project/post/1).</p>
                    </div>
                </div>
            </div>

            <!-- Form Handling -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Form Handling & Validation</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">WTForms Integration</h4>
                        <ul class="text-sm text-gray-600 space-y-2">
                            <li>• CreatePostForm for blog post creation</li>
                            <li>• RegisterForm for user registration</li>
                            <li>• LoginForm for user authentication</li>
                            <li>• CommentForm for post comments</li>
                            <li>• Built-in CSRF protection</li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Validation Features</h4>
                        <ul class="text-sm text-gray-600 space-y-2">
                            <li>• Required field validation</li>
                            <li>• Email format validation</li>
                            <li>• URL validation for images</li>
                            <li>• PIN format validation (4-6 digits)</li>
                            <li>• Unique email and badge validation</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Data Flow Example -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Data Flow Example: Creating a New Post</h3>
                <div class="bg-white p-6 rounded-lg shadow">
                    <div class="space-y-4">
                        <div class="flex items-start space-x-3">
                            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm font-medium">1</span>
                            <p class="text-gray-700">Authenticated user with 'executive' role navigates to /blog_project/new-post</p>
                        </div>
                        <div class="flex items-start space-x-3">
                            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm font-medium">2</span>
                            <p class="text-gray-700">@roles_required decorator validates user permissions</p>
                        </div>
                        <div class="flex items-start space-x-3">
                            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm font-medium">3</span>
                            <p class="text-gray-700">CreatePostForm is instantiated and rendered with CKEditor</p>
                        </div>
                        <div class="flex items-start space-x-3">
                            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm font-medium">4</span>
                            <p class="text-gray-700">User submits form, triggering POST request</p>
                        </div>
                        <div class="flex items-start space-x-3">
                            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm font-medium">5</span>
                            <p class="text-gray-700">Form validation checks CSRF token and required fields</p>
                        </div>
                        <div class="flex items-start space-x-3">
                            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm font-medium">6</span>
                            <p class="text-gray-700">New BlogPost object is created and saved to database</p>
                        </div>
                        <div class="flex items-start space-x-3">
                            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm font-medium">7</span>
                            <p class="text-gray-700">User is redirected to main blog page to see the new post</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Security Features -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Security Features</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Password Security</h4>
                        <ul class="text-sm text-gray-600 space-y-2">
                            <li>• werkzeug.security for password hashing</li>
                            <li>• PBKDF2 with SHA256 algorithm</li>
                            <li>• Salt length of 8 characters</li>
                            <li>• Separate hashing for passwords and PINs</li>
                            <li>• Never stores plaintext credentials</li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Access Control</h4>
                        <ul class="text-sm text-gray-600 space-y-2">
                            <li>• Role-based authorization system</li>
                            <li>• Decorator-based route protection</li>
                            <li>• Automatic redirect to login for unauthenticated users</li>
                            <li>• 403 Forbidden for unauthorized access</li>
                            <li>• Session-based authentication</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Back to Home -->
    <section class="py-8 bg-white">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div class="space-y-4">
                <a href="{{ url_for('blog.get_all_posts') }}" class="inline-block bg-blue-500 text-white py-3 px-6 rounded-lg hover:bg-blue-600 transition duration-300 text-lg font-semibold mr-4">Go to the Blog</a>
                <a href="{{ url_for('home') }}" class="inline-flex items-center text-blue-600 hover:text-blue-800 font-medium">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                    </svg>
                    Back to Home
                </a>
            </div>
        </div>
    </section>
</div>
{% endblock %} 